/*
 * FreeHost3270 a suite of terminal 3270 access utilities.
 * Copyright (C) 1998, 2001  Art Gillespie
 * Copyright (2) 2005 the http://FreeHost3270.Sourceforge.net
 *                        Project Contributors.
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */


package net.sf.freehost3270.client;

import junit.framework.TestCase;

import java.util.logging.Level;
import java.util.logging.Logger;


public class StreamParserTest extends TestCase {
    private short[] buf = {
            0x5, 0xc2, 0x1d, 0x60, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0xd4, 0xe2, 0xc7, 0xf1, 0xf0, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x5c, 0x60, 0x60, 0x60,
            0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
            0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
            0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
            0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
            0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
            0x60, 0x5c, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x6a,
            0x40, 0xe3, 0x88, 0x89, 0xa2, 0x40, 0x40, 0xa2, 0xa8, 0xa2, 0xa3,
            0x85, 0x94, 0x40, 0x89, 0xa2, 0x40, 0x89, 0x95, 0xa3, 0x85, 0x95,
            0x84, 0x85, 0x84, 0x40, 0xa3, 0x96, 0x40, 0x82, 0x85, 0x40, 0xa4,
            0xa2, 0x85, 0x84, 0x40, 0xa2, 0x96, 0x93, 0x85, 0x93, 0xa8, 0x40,
            0x82, 0xa8, 0x40, 0x40, 0x81, 0xa4, 0xa3, 0x88, 0x96, 0x99, 0x89,
            0xa9, 0x85, 0x84, 0x40, 0x6a, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x6a, 0x40, 0xa4, 0xa2, 0x85, 0x99, 0xa2, 0x40, 0x40,
            0x86, 0x96, 0x99, 0x40, 0x40, 0x93, 0x85, 0x87, 0x89, 0xa3, 0x89,
            0x94, 0x81, 0xa3, 0x85, 0x40, 0x40, 0x83, 0x96, 0x99, 0x97, 0x96,
            0x99, 0x81, 0xa3, 0x85, 0x40, 0x40, 0x82, 0xa4, 0xa2, 0x89, 0x95,
            0x85, 0xa2, 0xa2, 0x4b, 0x40, 0x40, 0x40, 0xe4, 0xa2, 0x85, 0x99,
            0xa2, 0x40, 0x40, 0x81, 0x99, 0x85, 0x40, 0x6a, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x6a, 0x40, 0x94, 0x96, 0x95, 0x89,
            0xa3, 0x96, 0x99, 0x85, 0x84, 0x40, 0xa3, 0x96, 0x40, 0xa3, 0x88,
            0x85, 0x40, 0x85, 0xa7, 0xa3, 0x85, 0x95, 0xa3, 0x40, 0x95, 0x85,
            0x83, 0x85, 0xa2, 0xa2, 0x81, 0x99, 0xa8, 0x40, 0x40, 0xa3, 0x96,
            0x40, 0x97, 0x99, 0x96, 0x97, 0x85, 0x99, 0x93, 0xa8, 0x40, 0x81,
            0x84, 0x94, 0x89, 0x95, 0x89, 0xa2, 0xa3, 0x85, 0x99, 0x40, 0x6a,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x6a, 0x40, 0xa3,
            0x88, 0x85, 0x40, 0xa2, 0xa8, 0xa2, 0xa3, 0x85, 0x94, 0x40, 0x81,
            0x95, 0x84, 0x40, 0xa3, 0x96, 0x40, 0x89, 0x95, 0xa5, 0x85, 0xa2,
            0xa3, 0x89, 0x87, 0x81, 0xa3, 0x85, 0x40, 0xa4, 0x95, 0x81, 0xa4,
            0xa3, 0x88, 0x96, 0x99, 0x89, 0xa9, 0x85, 0x84, 0x40, 0x81, 0x83,
            0x83, 0x85, 0xa2, 0xa2, 0x40, 0x96, 0x99, 0x40, 0xa4, 0xa2, 0x85,
            0x4b, 0x40, 0x6a, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x6a, 0x40, 0xc2, 0xa8, 0x40, 0x81, 0x83, 0x83, 0x85, 0xa2, 0xa2,
            0x89, 0x95, 0x87, 0x40, 0x40, 0xa3, 0x88, 0x89, 0xa2, 0x40, 0x40,
            0xa2, 0xa8, 0xa2, 0xa3, 0x85, 0x94, 0x6b, 0x40, 0x40, 0xa8, 0x96,
            0xa4, 0x40, 0x40, 0x81, 0x99, 0x85, 0x40, 0x40, 0x83, 0x96, 0x95,
            0xa2, 0x85, 0x95, 0xa3, 0x89, 0x95, 0x87, 0x40, 0xa3, 0x96, 0x40,
            0xa3, 0x88, 0x89, 0xa2, 0x40, 0x6a, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x6a, 0x40, 0x94, 0x96, 0x95, 0x89, 0xa3, 0x96,
            0x99, 0x89, 0x95, 0x87, 0x4b, 0x40, 0x40, 0x40, 0xe4, 0x95, 0x81,
            0xa4, 0xa3, 0x88, 0x96, 0x99, 0x89, 0xa9, 0x85, 0x84, 0x40, 0xa4,
            0xa2, 0x85, 0x40, 0x89, 0xa2, 0x40, 0xa2, 0xa4, 0x82, 0x91, 0x85,
            0x83, 0xa3, 0x40, 0xa3, 0x96, 0x40, 0x97, 0x99, 0x96, 0xa2, 0x85,
            0x83, 0xa4, 0xa3, 0x89, 0x96, 0x95, 0x4b, 0x40, 0x6a, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x5c, 0x60, 0x60, 0x60, 0x60,
            0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
            0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
            0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
            0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
            0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
            0x5c, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0xc6, 0x96, 0x99, 0x40, 0xd7, 0x99,
            0x96, 0x82, 0x93, 0x85, 0x94, 0xa2, 0x61, 0xc1, 0xa2, 0xa2, 0x89,
            0xa2, 0xa3, 0x81, 0x95, 0x83, 0x85, 0x40, 0x83, 0x81, 0x93, 0x93,
            0x40, 0xa3, 0x88, 0x85, 0x40, 0x88, 0x96, 0xa3, 0x93, 0x89, 0x95,
            0x85, 0x40, 0x81, 0xa3, 0x40, 0x40, 0x4d, 0xf7, 0xf3, 0xf2, 0x5d,
            0x40, 0xf6, 0xf9, 0xf9, 0x60, 0xf4, 0xf1, 0xf0, 0xf0, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
            0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0xc9, 0xd5, 0xd7, 0xe4, 0xe3,
            0x40, 0xc1, 0xd7, 0xd7, 0xd3, 0xc9, 0xc3, 0xc1, 0xe3, 0xc9, 0xd6,
            0xd5, 0x40, 0xd5, 0xc1, 0xd4, 0xc5, 0x40, 0xc1, 0xd5, 0xc4, 0x40,
            0xd7, 0xd9, 0xc5, 0xe2, 0xe2, 0x40, 0xc5, 0xd5, 0xe3, 0xc5, 0xd9,
            0x11, 0xd9, 0x40, 0x1d, 0x40, 0x13
        };

    public void testInit() throws Exception {
        RWTnActionAdapter client = new RWTnActionAdapter();
        RW3270 rw = new RW3270(client);
        RWTn3270StreamParser parser = new RWTn3270StreamParser(rw, client);

        parser.parse(buf, buf.length);

        client.dumpLog(rw);
    }
}


/**
 * Implements methods from the <code>RWTnAction</code> interface. Use this
 * adapter as a stub parent class where the objects implementing RWTnAction
 * are required.
 *
 * @see RWTnAction
 */
class RWTnActionAdapter implements RWTnAction {
    private static final Logger log = Logger.getLogger(
            "net.sf.freehost3270.StreamParserDump");
    private static final Level logLevel = Level.FINE;
    private StringBuffer buff = new StringBuffer();

    public void beep() {
        if (log.isLoggable(logLevel)) {
            appendCall("(beep)");
        }
    }

    public void broadcastMessage(String msg) {
        if (log.isLoggable(logLevel)) {
            appendCall("(broadcast-message " + msg + ")");
        }
    }

    public void cursorMove(int oldPos, int newPos) {
        if (log.isLoggable(logLevel)) {
            appendCall("(move-cursor " + oldPos + " " + newPos + ")");
        }
    }

    public void dumpLog(RW3270 rw) {
        if (log.isLoggable(logLevel)) {
            buff.append(rw.toString());
            log.log(logLevel, buff.toString());
        }
    }

    public void incomingData() {
        if (log.isLoggable(logLevel)) {
            appendCall("(incoming-data)");
        }
    }

    public void status(int msg) {
        if (log.isLoggable(logLevel)) {
            appendCall("(status " + msg + ")");
        }
    }

    /**
     * Outputs given string representation of the call to the form acceptable
     * by the Java compiler as a static array.
     *
     * @param call DOCUMENT ME!
     */
    private void appendCall(String call) {
        buff.append("{\"").append(call).append("\"},\n");
    }
}
